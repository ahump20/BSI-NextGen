# Cloudflare Worker Configuration for Blaze Monitor (Database Monitoring)

name = "blaze-monitor"
main = "src/index.ts"
compatibility_date = "2024-11-13"
node_compat = true

# Account details (replace with your account ID)
# Run: wrangler whoami
account_id = "YOUR_ACCOUNT_ID"

# Worker settings
workers_dev = true

# Routes (configure after deployment)
# routes = [
#   { pattern = "monitor.blazesportsintel.com/*", zone_name = "blazesportsintel.com" }
# ]

# D1 Database binding (for storing metrics)
[[d1_databases]]
binding = "DB"
database_name = "blaze-monitor-db"
database_id = "YOUR_DATABASE_ID"  # Will be set after running: npm run db:create

# KV Namespace binding (for caching)
[[kv_namespaces]]
binding = "BLAZE_MONITOR_CACHE"
id = "YOUR_KV_NAMESPACE_ID"  # Will be set after running: npm run kv:create
preview_id = "YOUR_KV_PREVIEW_ID"  # Will be set after running: npm run kv:create:preview

# Environment variables for database connections
# Set via wrangler secret put
# DATABASE_URLS - JSON array of database connection info

# Cron triggers - Run monitoring every 5 minutes
[triggers]
crons = ["*/5 * * * *"]

# Limits and settings
[limits]
cpu_ms = 30000  # 30 seconds max CPU time

# Build configuration
[build]
command = ""

# Development mode
[env.development]
name = "blaze-monitor-dev"

# Production environment
[env.production]
name = "blaze-monitor-production"
workers_dev = false
