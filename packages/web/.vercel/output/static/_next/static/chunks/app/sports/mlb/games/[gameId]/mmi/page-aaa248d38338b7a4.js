(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[297],{563:function(e,t,s){Promise.resolve().then(s.bind(s,2635))},2635:function(e,t,s){"use strict";s.d(t,{MMIDashboard:function(){return l}});var a=s(4980),r=s(4804),i=s(9307);function l(e){let{gameId:t,role:s="pitcher",className:l=""}=e,[d,o]=(0,r.useState)(null),[m,h]=(0,r.useState)(!0),[p,g]=(0,r.useState)(null);if((0,r.useEffect)(()=>{(async function(){try{h(!0),g(null);let e=await fetch("/api/sports/mlb/mmi/games/".concat(t,"?role=").concat(s));if(!e.ok){let t=await e.json().catch(()=>({}));throw Error(t.error||"Failed to fetch MMI data: ".concat(e.statusText))}let a=await e.json();o(a)}catch(e){g(e instanceof Error?e.message:"Unknown error occurred"),console.error("[MMI Dashboard] Error:",e)}finally{h(!1)}})()},[t,s]),m)return(0,a.jsx)("div",{className:"flex items-center justify-center p-8 ".concat(l),children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Loading MMI data..."})]})});if(p)return(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 ".concat(l),children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("svg",{className:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-red-800",children:"Error Loading MMI Data"}),(0,a.jsx)("p",{className:"mt-2 text-sm text-red-600",children:p}),(0,a.jsx)("p",{className:"mt-2 text-xs text-red-500",children:"Ensure the MMI service is running and accessible."})]})]})});if(!d||!d.pitches.length)return(0,a.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-8 text-center ".concat(l),children:[(0,a.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})}),(0,a.jsx)("p",{className:"text-gray-600 font-medium",children:"No MMI data available for this game"}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 mt-2",children:["Game ID: ",t]})]});let u=d.pitches.reduce((e,t)=>e+t.mmi,0)/d.pitches.length,j=Math.max(...d.pitches.map(e=>e.mmi));d.pitches.map(e=>e.mmi);let y=d.pitches.filter(e=>e.mmi>2).length,f=[...d.pitches].sort((e,t)=>t.mmi-e.mmi).slice(0,5);return(0,a.jsxs)("div",{className:"space-y-6 ".concat(l),children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:["pitcher"===s?"Pitcher":"Batter"," Mental Demand Summary"]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsx)(n,{label:"Average MMI",value:u.toFixed(2),description:"Mean mental demand across all pitches",category:(0,i.getMMICategory)(u)}),(0,a.jsx)(n,{label:"Peak MMI",value:j.toFixed(2),description:"Highest mental demand moment",category:(0,i.getMMICategory)(j)}),(0,a.jsx)(n,{label:"High-Leverage Pitches",value:y.toString(),description:"Pitches with MMI > 2.0"}),(0,a.jsx)(n,{label:"Total Pitches",value:d.pitches.length.toString(),description:"Events analyzed"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top 5 Most Mentally Demanding Moments"}),(0,a.jsx)("div",{className:"space-y-3",children:f.map((e,t)=>(0,a.jsx)(c,{pitch:e,rank:t+1},"".concat(e.inning,"-").concat(e.outs,"-").concat(t)))})]}),d.player_summaries&&d.player_summaries.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["pitcher"===s?"Pitcher":"Batter"," MMI Summary"]}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 rounded-lg overflow-hidden",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Player"}),(0,a.jsx)("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pitches"}),(0,a.jsx)("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Avg MMI"}),(0,a.jsx)("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"P90 MMI"}),(0,a.jsx)("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Max MMI"}),(0,a.jsx)("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"High-Leverage"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:d.player_summaries.map(e=>(0,a.jsx)(x,{player:e},e.player_id))})]})})]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 border-t pt-4",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Data Source:"})," ",d.meta.dataSource]}),(0,a.jsxs)("p",{className:"mt-1",children:[(0,a.jsx)("span",{className:"font-medium",children:"Last Updated:"})," ",new Date(d.meta.lastUpdated).toLocaleString("en-US",{timeZone:"America/Chicago",dateStyle:"short",timeStyle:"short"})," ","CST"]})]})]})}function n(e){let{label:t,value:s,description:r,category:i}=e;return(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:border-blue-300 transition-colors",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:t}),(0,a.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,a.jsx)("p",{className:"text-3xl font-bold text-gray-900",children:s}),i&&(0,a.jsx)("span",{className:"text-xs font-medium px-2 py-1 rounded-full bg-gray-100 text-gray-700",children:i})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:r})]})}function c(e){let{pitch:t,rank:s}=e,r=(0,i.getMMICategoryColor)(t.mmi);return(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:border-blue-400 hover:shadow-md transition-all",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-4 mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"bg-blue-600 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold text-sm flex-shrink-0",children:s}),(0,a.jsxs)("div",{className:"min-w-0",children:[(0,a.jsxs)("p",{className:"font-semibold text-gray-900 truncate",children:[(0,i.formatInning)(t.inning,t.is_top_inning),", ",t.outs," out",1!==t.outs?"s":""]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 truncate",children:[t.pitcher_name," vs ",t.batter_name]})]})]}),(0,a.jsxs)("div",{className:"text-right flex-shrink-0",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:t.mmi.toFixed(2)}),(0,a.jsx)("p",{className:"text-xs font-medium px-2 py-0.5 rounded-full inline-block ".concat(r),children:(0,i.getMMICategory)(t.mmi)})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-5 gap-2 text-xs text-gray-600 pt-3 border-t border-gray-100",children:[(0,a.jsx)(d,{label:"Count",value:(0,i.formatCount)(t.balls,t.strikes)}),(0,a.jsx)(d,{label:"Bases",value:t.base_state}),(0,a.jsx)(d,{label:"Score",value:t.score_diff>0?"+".concat(t.score_diff):t.score_diff.toString()}),(0,a.jsx)(d,{label:"LI",value:t.leverage_index.toFixed(2)}),(0,a.jsx)(d,{label:"Velocity",value:t.pitch_velocity?"".concat(t.pitch_velocity.toFixed(1)," mph"):"N/A"})]})]})}function d(e){let{label:t,value:s}=e;return(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500 text-xs",children:t}),(0,a.jsx)("p",{className:"font-medium text-gray-900",children:s})]})}function x(e){let{player:t}=e,s=(0,i.getMMICategoryColor)(t.mean_mmi);return(0,a.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors",children:[(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:t.player_name})}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-right",children:(0,a.jsx)("div",{className:"text-sm text-gray-600",children:t.count})}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-right",children:(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ".concat(s),children:t.mean_mmi.toFixed(2)})}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-right",children:(0,a.jsx)("div",{className:"text-sm text-gray-900",children:t.p90_mmi.toFixed(2)})}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-right",children:(0,a.jsx)("div",{className:"text-sm font-semibold text-blue-600",children:t.max_mmi.toFixed(2)})}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-right",children:(0,a.jsx)("div",{className:"text-sm text-gray-600",children:t.high_mmi_count})})]})}}},function(e){e.O(0,[944,543,586,744],function(){return e(e.s=563)}),_N_E=e.O()}]);